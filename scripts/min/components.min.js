!function(){"use strict";function e(o){this.options=t.extend({},n.defaults,e.defaults,o),this.element=this.options.element,this.$element=t(this.element),this.createWrapper(),this.createWaypoint()}var t=window.jQuery,n=window.Waypoint;e.prototype.createWaypoint=function(){var e=this.options.handler;this.waypoint=new n(t.extend({},this.options,{element:this.wrapper,handler:t.proxy(function(t){var n=this.options.direction.indexOf(t)>-1,o=n?this.$element.outerHeight(!0):"";this.$wrapper.height(o),this.$wrapper.css({position:"relative","z-index":1}),this.$element.toggleClass(this.options.stuckClass,n),e&&e.call(this,t)},this)}))},e.prototype.createWrapper=function(){this.options.wrapper&&this.$element.wrap(this.options.wrapper),this.$wrapper=this.$element.parent(),this.wrapper=this.$wrapper[0]},e.prototype.destroy=function(){this.$element.parent()[0]===this.wrapper&&(this.waypoint.destroy(),this.$element.removeClass(this.options.stuckClass),this.options.wrapper&&this.$element.unwrap())},e.defaults={wrapper:'<div class="sticky-wrapper" />',stuckClass:"stuck",direction:"down right"},n.Sticky=e}();var nret=nret||{};!function(e){nret.helpers={isIe:function(){e(window).load(function(){navigator.userAgent.match(/Trident.*rv:11\./)&&nret.helpers.els.body.addClass("ie11")})},awfulFixToMobileSearchBarNotFocusing:function(){e("#globalSearchMbl").find("input").on("touchstart",function(){e(this).css("width","84%")})},countrySelectEvent:function(){e("#initCountrySelect").on("click",function(){e(".global-nav__banner__country-dropdown").toggleClass("open")})},disableScrolling:function(){e.fn.scrollLock=function(){return e(this).on("DOMMouseScroll mousewheel",function(t){var n=e(this),o=this.scrollTop,i=this.scrollHeight,a=n.height(),r=t.originalEvent.wheelDelta,s=r>0,l=function(){return t.stopPropagation(),t.preventDefault(),t.returnValue=!1,!1};return!s&&-r>i-a-o?(n.scrollTop(i),l()):s&&r>o?(n.scrollTop(0),l()):void 0})},e.fn.scrollRelease=function(){return e(this).off("DOMMouseScroll mousewheel")}},closeElementOnDocumentClick:function(){e(document).on("click",function(t){e(t.target).closest(".doNotClose, .ui-icon, .ui-corner-all").length||(e(".open").removeClass("show show-now"),e(".filter__options-wrapper__filter-option").length&&e(".filter__options-wrapper__filter-option").removeClass("open"))})},whatTypeOfDevice:function(){"Tablet"==WURFL.form_factor?(nret.helpers.els.body.addClass("device-tablet"),nret.helpers.els.body.addClass("mobile")):"Smartphone"==WURFL.form_factor?(nret.helpers.els.body.addClass("device-phone"),nret.helpers.els.body.addClass("mobile")):(nret.helpers.els.body.addClass("device-desktop"),nret.helpers.els.body.addClass("desktop"))},triggerClickOnFooterNewsletterLink:function(){if(nret.helpers.els.body.hasClass("mobile")){e(".footer__item.newsletter").find(".footer__item-title").on("click",function(){e(this).next().trigger("click")})}},validateEmailEvent:function(){e(".form-submit").on("submit",function(){var t=e(this).find(".email-validation"),n=t.val();return 0!=nret.helpers.validateEmail(n)})},validateEmail:function(e){return/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i.test(e)},noLink:function(){e(".nolink").on("click",function(e){e.preventDefault()})},lazyLoad:function(){e(".lazy").lazyload({threshold:500})},openMoreOnActivitiesMapListEvent:function(){e(".image-on-image__intro-copy__list-item").find("h4").on("click",function(){var t=e(this).parent();t.hasClass("open")?e(".image-on-image__intro-copy__list-item").removeClass("open"):(e(".image-on-image__intro-copy__list-item").not(t).removeClass("open"),t.addClass("open")),nret.helpers.closeMoreOnActivitiesMapList(t),nret.helpers.openMoreOnActivitiesMapList(t)})},openMoreOnActivitiesMapList:function(e){e.hasClass("open")&&(e.find(".long-dash").velocity({width:30,marginRight:10},{duration:200}),e.find(".image-on-image__list-copy").velocity({maxHeight:600,opacity:1},{duration:800}))},closeMoreOnActivitiesMapList:function(t){e(".image-on-image__intro-copy__list-item").find(".long-dash").velocity({width:0,marginRight:0}),e(".image-on-image__intro-copy__list-item").find(".image-on-image__list-copy").velocity({maxHeight:0,opacity:0})},revealHidden:function(){e(".hide-block").each(function(t,n){var n=e(n);n.visible(!0)&&n.addClass("reveal-block")})},revealHiddenOnScroll:function(){nret.helpers.els.win.scroll(function(e){nret.helpers.revealHidden()})},phoneHelperOpen:function(){e(".explorer__help-modal-inner").velocity({opacity:1},{display:"flex"})},phoneHelperClose:function(){e(".explorer__help-modal-inner").velocity({opacity:0},{display:"none"}),e(".explorer__help-modal").velocity({backgroundColorAlpha:0})},phoneHelperCloseAfterTime:function(){function t(){e(".explorer__phone").find(".inner").hasClass("fresh")&&(nret.helpers.phoneHelperClose(),e(".explorer__phone").find(".inner").removeClass("open"))}window.setTimeout(t,1e4)},phoneHelperEvent:function(){e(".explorer__phone").find(".inner").on("click",function(){e(this).removeClass("fresh"),e(this).hasClass("open")?(nret.helpers.phoneHelperClose(),e(this).removeClass("open")):(e(this).addClass("open"),nret.helpers.phoneHelperOpen())})},animateIdlePhone:function(){function t(){setInterval(n,5e4)}function n(){e(".explorer__phone").find(".inner").hasClass("open")||e(".explorer__phone").addClass("tada").delay(1200).queue(function(t){e(this).removeClass("tada"),t()})}window.setTimeout(t,1e4)},sortDestinationNamesAlphabeticallyByState:function(){$groups=e(".sort-list");var t=function(t,n){return t=e(t).find(".strike").text().split(","),n=e(n).find(".strike").text().split(","),t=t[t.length-1],n=n[n.length-1],t==n?0:t<n?-1:1},n=function(t,n){return t=e(t).find(".strike").text(),n=e(n).find(".strike").text(),t==n?0:t<n?-1:1},o=function(e,o){return t(e,o)||n(e,o)};$groups.each(function(){var t=e(this).find("li"),n=t.sort(o);e(this).html(n)})},dropdownEvents:function(){e(".select-dropdown").not(".region").on("click",function(){var t=e(this),n=e(this).next().attr("id");nret.helpers.showDropdown(n),nret.helpers.changeDropdownTabValue(t)}),e(".select-wrapper select, .state-select-wrapper select, .contact__topic-wrapper select").not("#acquisitionFormRegion").unbind("change").on("change",function(){var t=e(this).prev(),n=e(this).val();t.html(n+'<span class="icon icon_carrot-down"></span>')})},changeDropdownTabValue:function(e){$this=e,$this.next().unbind("change").on("change",function(){val=$this.next().val(),$this.html(val+'<span class="icon icon_carrot-down"></span>')})},showDropdown:function(e){var t,n=document.getElementById(e);t=document.createEvent("MouseEvents"),t.initMouseEvent("mousedown",!0,!0,window),n.dispatchEvent(t)},openMobileAmenitiesList:function(e){var t=e.next();t.hasClass("grow")?t.removeClass("grow"):t.addClass("grow")},openMobileAmenitiesListEvent:function(){e(".amenities-block").find("header").on("click",function(){$this=e(this),nret.helpers.openMobileAmenitiesList($this),$this.find(".icon").toggleClass("open")})},adjustMarginTopForElementBelowHomeHero:function(){if(e(window).innerHeight()>0&&nret.helpers.els.body.hasClass("desktop")&&e(".hero-el").length>0){var t=e(".hero-el").innerHeight()-40;e(".hero-el__below").css("marginTop",t)}},adjustMarginTopOnResize:function(){e(window).on("resize",function(){nret.helpers.adjustMarginTopForElementBelowHomeHero()})},openCalOnLabelClick:function(){e(".cal").find(".input-label").on("click",function(){e(".cal").find(".input-container").removeClass("show"),e(this).siblings(".input-container").toggleClass("show"),e(".growMeMore, .growMe").removeClass("show")})},init:function(){nret.helpers.els={body:e("body"),win:e(window)},nret.helpers.noLink(),nret.helpers.isIe(),nret.helpers.openCalOnLabelClick(),nret.helpers.whatTypeOfDevice(),nret.helpers.lazyLoad(),nret.helpers.sortDestinationNamesAlphabeticallyByState(),nret.helpers.openMoreOnActivitiesMapListEvent(),nret.helpers.revealHidden(),nret.helpers.revealHiddenOnScroll(),nret.helpers.dropdownEvents(),nret.helpers.disableScrolling(),nret.helpers.closeElementOnDocumentClick(),nret.helpers.phoneHelperEvent(),nret.helpers.phoneHelperCloseAfterTime(),nret.helpers.animateIdlePhone(),nret.helpers.validateEmailEvent(),nret.helpers.openMobileAmenitiesListEvent(),nret.helpers.countrySelectEvent(),nret.helpers.awfulFixToMobileSearchBarNotFocusing(),nret.helpers.triggerClickOnFooterNewsletterLink(),nret.helpers.adjustMarginTopForElementBelowHomeHero(),nret.helpers.adjustMarginTopOnResize()}},jQuery(document).ready(function(){nret.helpers.init()})}(jQuery);var nret=nret||{};!function(e,t){var n;e("#acquisitionForm").submit(function(o){o.preventDefault();var i=e(this).serializeArray(),a=e("#acquisitionForm input[type=submit]").val(),r=e(".acquisition__thankyou");e("#acquisitionForm input[type=submit]").val("Sending..."),e.ajax({dataType:"json",type:"POST",url:"/themes/nretreats/templates/acquisition-form.php",data:i,success:function(o){o.success?(e("#acquisitionForm input[type=submit]").val("Sent"),r.addClass("show")):e("#acquisitionForm input[type=submit]").val("Error, Try Again"),t.clearTimeout(n),n=setTimeout(function(){e("#acquisitionForm input[type=submit]").val(a),r.removeClass("show")},5e3)}})}),e("#acquisitionFormRegion").on("change",function(t){var n=e(this),o=n.val();n.parent().find("span.value").html(o),n.find("option.remove").remove(),"US"===o||"Other"===o?(e(".change-city-placeholder").attr("placeholder","City"),e(".uk-county-field")[0]&&e(".uk-county-field").replaceWith('<div class="us-state state-select-wrapper"><div class="select-dropdown">State<span class="icon icon_carrot-down"></span></div><select name="USER_STATE" id="acquisitionFormState"><option value="AL">Alabama</option><option value="AK">Alaska</option><option value="AZ">Arizona</option><option value="AR">Arkansas</option><option value="CA">California</option><option value="CO">Colorado</option><option value="CT">Connecticut</option><option value="DE">Delaware</option><option value="DC">District Of Columbia</option><option value="FL">Florida</option><option value="GA">Georgia</option><option value="HI">Hawaii</option><option value="ID">Idaho</option><option value="IL">Illinois</option><option value="IN">Indiana</option><option value="IA">Iowa</option><option value="KS">Kansas</option><option value="KY">Kentucky</option><option value="LA">Louisiana</option><option value="ME">Maine</option><option value="MD">Maryland</option><option value="MA">Massachusetts</option><option value="MI">Michigan</option><option value="MN">Minnesota</option><option value="MS">Mississippi</option><option value="MO">Missouri</option><option value="MT">Montana</option><option value="NE">Nebraska</option><option value="NV">Nevada</option><option value="NH">New Hampshire</option><option value="NJ">New Jersey</option><option value="NM">New Mexico</option><option value="NY">New York</option><option value="NC">North Carolina</option><option value="ND">North Dakota</option><option value="OH">Ohio</option><option value="OK">Oklahoma</option><option value="OR">Oregon</option><option value="PA">Pennsylvania</option><option value="RI">Rhode Island</option><option value="SC">South Carolina</option><option value="SD">South Dakota</option><option value="TN">Tennessee</option><option value="TX">Texas</option><option value="UT">Utah</option><option value="VT">Vermont</option><option value="VA">Virginia</option><option value="WA">Washington</option><option value="WV">West Virginia</option><option value="WI">Wisconsin</option><option value="WY">Wyoming</option></select></div>'),e(".zip-to-post").attr("placeholder","Zip Code"),e(".hidden-for-uk").show(),e(".hidden-for-uk .required").attr("required","")):"UK/Europe"==o&&(e(".change-city-placeholder").attr("placeholder","Town"),e(".us-state.state-select-wrapper")[0]&&e(".us-state.state-select-wrapper").replaceWith('<input class="uk-county-field" type="text" name="USER_STATE" placeholder="County" required>'),e(".zip-to-post").attr("placeholder","Postcode"),e(".hidden-for-uk").hide(),e(".hidden-for-uk *[required]").addClass("required").removeAttr("required")),e("#main-acquisition-form-content").removeClass("hidden")})}(jQuery,window);var nret=nret||{};!function(e){nret.bazaar={submitGeneric:function(){$BV.ui("rr","submit_generic",{})},initGenericFormEvent:function(){e("#initReviewsGeneric").on("click",function(){nret.bazaar.submitGeneric()})},init:function(){nret.bazaar.initGenericFormEvent()}},jQuery(document).ready(function(){nret.bazaar.init()})}(jQuery);var nret=nret||{};!function(e,t){nret.booking={init:function(){nret.booking.trackGuestDetails(),nret.booking.bookingSubmitDisable()},bookingSubmitDisable:function(){e(".retreat_guest_form_submit").on("click",function(t){var n=!0;e(".email-validation, .phone-validation, .zip-validation, .creditcard-select").each(function(){""==e(this).val()&&(n=!1)}),n&&e(".retreat_guest_form_submit").addClass("disabled")})},sendToBVOnSuccess:function(e,t,n,o,i,a){var r=moment(o).format("YYYY-MM-DD");$BV.SI.trackTransactionPageView({orderId:e,tax:t,total:n,shippingDate:r,items:[{sku:i}],email:a})},trackBooking:function(e,n,o,i,a,r){t("require","ecommerce"),t("ecommerce:addTransaction",{id:e,affiliation:"Natural Retreats",revenue:n,tax:o}),t("ecommerce:addItem",{id:e,name:i,sku:a,category:r}),t("ecommerce:send")},trackGuestDetails:function(){var t,n,o=e(".guestInfo__form .step1"),i=o.find("input"),a={Title:"sir",ReceiveOffers:0,Country:"na"};i.on("keypress",function(){n=!0,t&&clearTimeout(t),t=setTimeout(function(){_.each(i,function(t){var o=e(t);a[o.attr("name")]=o.val(),""===o.val()&&(n=!1)}),n&&e.post("/api/v1/createguest",a)},3e3)})},submitPromoCodeFromBookingWidget:function(){e("#applyBookingPromo").on("click",function(){if(nret.booking.formIsValidForPromoApply()){var t,n=e("#bookingAdultCount").val();t=""==e("#bookingChildrenCount").val()?0:e("#bookingChildrenCount").val();var o=parseInt(n)+parseInt(t),i={3:"&#36;",2:"&#8364;",1:"&#163;"},a=e("#bookingDestinationId").val(),r=e(".input__promo").val(),s=e("#bookingRetreatId").val(),l=e("#bookingRegionId").val(),c=e("#booking-nights").val(),d=e("#check-in").datepicker("getDate"),u=new Array("JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"),p=d.getDate(),h=d.getMonth(),f=d.getFullYear(),d=p+"-"+u[h]+"-"+f,v="/api/v1/checkdiscountcode/"+a+"/"+s+"/"+l+"/"+r+"/"+d+"/"+c+"/"+o;e("#bookingGuestsCount").val(o),e.ajax({url:v,success:function(t){if(t.data&&t.data.NewPrice){var n=t.data.NewPrice;e("#newBookingWidgetPromoPrice").html("The total price for your stay is "+i[l]+n),Cookies.set("promo_code",r)}else e(".input__promo, .booking-widget__promo-field__submit").addClass("promo-error"),e(".booking-widget__promo-error").addClass("show")},error:function(t){e(".input__promo, .booking-widget__promo-field__submit").addClass("promo-error"),e(".booking-widget__promo-error").addClass("show")}})}})},formIsValidForPromoApply:function(){var t=!0,n=e("#bookingCheckIn"),o=e("#bookingCheckOut"),i=e(".booking-widget__promo-field input"),a=e("#bookingAdultCount"),r=e(".input__promo");return null===n.datepicker("getDate")&&(t=!1),null===o.datepicker("getDate")&&(t=!1),i.val()||(t=!1),a.val()||(t=!1),r.val()||(t=!1),t},setPromoCodeIfExists:function(){var t=Cookies.get("promo_code"),n=e("#promoCode");void 0!==t&&(n.val(t),n.prop("disabled",!0),e("#bookingPromoApply").remove())},resubmitWithNewPromoCode:function(t){var n=e("#promoCodeResubmit"),o=t,i=e("<input>");i.attr("type","hidden"),i.attr("name","DiscountCode"),i.attr("value",o),Cookies.set("promo_code",o),nret.booking.setPromoCodeIfExists(),n.append(i),n.submit()},resubmitPromoCodeEvent:function(){e("#bookingPromoApply").on("click",function(){var t=e("#promoCode").val();""!==t&&nret.booking.resubmitWithNewPromoCode(t)})}},jQuery(document).ready(function(){nret.booking.submitPromoCodeFromBookingWidget(),nret.booking.setPromoCodeIfExists(),nret.booking.resubmitPromoCodeEvent()})}(jQuery,ga);var nret=nret||{};!function(e){var t={3:"&#36;",2:"&#8364;",1:"&#163;"},n=e("#bookingRegionId").val(),o=t[n];nret.braintree={init:function(t){var n={MSCD:.02,VISA:.02,JCB:.03},i=!1;e(".creditcard-select").on("change",function(){var t=e('input[name="Amount"]'),a=t.attr("value"),r=e(this).val(),s=e(this).data("region");if(i||(i=a),e("#braintree-form").removeClass("hidden"),e(".grandtotal-table").find(".creditcard-fee").remove(),(1==s||2==s)&&n[r]){var l=i*n[r];l=l.toFixed(2),e(".grandtotal-table").append('<tr class="creditcard-fee"><td>credit card fee</td><td>'+o+l+"</td></tr>")}}),nret.braintree.form=t.form,braintree.setup(t.braintreeToken,"dropin",{container:t.container,onPaymentMethodReceived:function(e){nret.braintree.paymentMethodReceived(e)}})},paymentMethodReceived:function(e){nret.braintree.form.append('<input type="hidden" value="'+e.nonce+'" name="Nonce">').submit()}}}(jQuery);var nret=nret||{};!function(e,t){var n="dd-M-yy",o="dd-M-y",i="M dd",a=window.innerWidth<769?1:2,r=e("#check-in"),s=e("#check-out"),l=e(".check-in-overlay"),c=e(".checkin-sublabel"),d=e(".check-out-overlay"),u=e(".checkout-sublabel"),p=e("#bookingAdultCount"),h=e("#bookingChildrenCount"),f=e("#booking-error"),v=e("#bookingWidgetForm"),m=e('#bookingWidgetForm button[type="submit"]'),g=e("#bookingRegionId").val(),k={3:"&#36;",2:"&#8364;",1:"&#163;"},y={currencySymbol:k[g],retreatId:e(".retreat").attr("data-retreat-id"),nodeId:e(".retreat").attr("data-node-id")},b=function(a){function g(){e(".filter__options-wrapper__filter-option.filter__dropdown .strike").on("click",function(){var t=e(this),n=t.text();e("#"+e(this).data("inputTarget")).val(n)}),e(".launch-mobile-booking-widget").click(function(){v.addClass("open"),e("html").addClass("no-scroll-mobile")}),e(".close-mobile-booking-widget").click(function(){v.removeClass("open"),e("html").removeClass("no-scroll-mobile")}),e("#bookingPetsCheck").on("change",function(){A.updatePrice()}),v.submit(function(o){k()||o.preventDefault();var i=r.datepicker("getDate"),a=e.datepicker.formatDate(n,i).toUpperCase(),s=p.val()?parseInt(p.val()):0,l=h.val()?parseInt(h.val()):0,c=s+l;e("#bookingStartDate").val(a),e("#bookingGuestsCount").val(c),e("#bookingPetsCheck").is(":checked")?e("#bookingPets").val("1"):e("#bookingPets").val("0"),nret.booking.sendToBVOnSuccess(0,0,e("#display-price-h").val(),"",e(".retreat").attr("data-retreat-id"),""),t.set("retreat_id",e(".retreat").attr("data-retreat-id")),t.set("region_id",e("#bookingRegionId").val()),""===e(".input__promo").val()&&t.remove("promo_code")}),p.on("change",function(){p.parent().removeClass("booking-error")})}function k(){A.hideBookingError();for(var t=[{$element:r,name:"check in date"},{$element:s,name:"check out date"},{$element:p,name:"guest amount"}],n=!1,o="Please select your",i=[],a=0;a<t.length;a++){""!==t[a].$element.val()?"guest amount"===t[a].name?t[a].$element.parent().removeClass("booking-error"):t[a].$element.parent().hasClass("init-error")&&(n=!0):(n=!0,t[a].$element.parent().addClass("booking-error"),i.push(t[a].name))}if(h.parent().removeClass("booking-error"),n){switch(i.length){case 1:o+=" "+i[0];break;case 2:o+=" "+i[0]+" and "+i[1];break;default:for(var a=0;a<i.length;a++)a===i.length-1?o+=", and":0!==a&&(o+=","),o+=" "+i[a]}return A.showBookingError(o),!1}return(p.val()?parseInt(p.val()):0)+(h.val()?parseInt(h.val()):0)>parseInt(e("#sleeps").val())?(p.parent().addClass("booking-error"),h.val()&&h.parent().addClass("booking-error"),A.showBookingError("Your selection exceeds the maximum guest amount."),!1):(p.parent().removeClass("booking-error"),h.parent().removeClass("booking-error"),!0)}function y(e,t){A.checkInDatepicker.preloadDate(e),A.checkOutDatepicker.preloadDate(t)}function b(e,t){var n=e.hasOwnProperty("caldate")?e.caldate:e.deptdate,o=t.hasOwnProperty("caldate")?t.caldate:t.deptdate;return new Date(n)<new Date(o)?-1:new Date(n)>new Date(o)?1:0}function _(){D(),S(),e("#newBookingWidgetPromoPrice").html(L)}function D(){A.checkInDatepicker.clear(),t.remove("nret[start_date]")}function S(){A.checkOutDatepicker.clear(),A.departureDates=[],A.departureDatesBeyond=[],t.remove("nret[end_date]")}function M(t,o){A.checkInDatepicker.showLoader(),e("#initEnquiry").prop("disabled",!0);var i=e.datepicker.formatDate(n,t).toUpperCase();return e.get("/api/v1/getoptarrival/"+a.retreatId+"/"+i,function(t){A.checkInDatepicker.hideLoader(),t.error||null===t.data?A.showBookingError("Error getting check in dates."):(e.merge(A.arrivalDates,t.data),A.arrivalDates.sort(b),"function"==typeof o&&o())})}function x(t,o){A.checkOutDatepicker.showLoader();var i=e.datepicker.formatDate(n,t).toUpperCase();return e.get("/api/v1/getoptdeparture/"+a.retreatId+"/"+i,function(e){if(A.checkOutDatepicker.hideLoader(),e.error)A.showBookingError("Error getting check out dates.");else{for(var t=0;t<e.data.length;t++){var n=e.data[t];A.departureDates.filter(function(e){return e.deptdate===n.deptdate})[0]||A.departureDates.push(n)}A.departureDates.sort(b),"function"==typeof o&&o()}})}function E(t,o){A.checkOutDatepicker.showLoader();var i=e.datepicker.formatDate(n,t).toUpperCase();return e.get("/api/v1/getoptdeparture/"+a.retreatId+"/"+i,function(e){if(A.checkOutDatepicker.hideLoader(),e.error)A.showBookingError("Error getting check out dates.");else{for(var t=0;t<e.data.length;t++){var n=e.data[t];A.departureDatesBeyond.filter(function(e){return e.deptdate===n.deptdate})[0]||A.departureDatesBeyond.push(n)}A.departureDatesBeyond.sort(b),"function"==typeof o&&o()}})}function I(){f.hide().text(""),m.removeClass("booking-error")}function T(){e("#calendar-error").remove()}function F(e){f.show().text(e),m.addClass("booking-error")}function q(t){var n=['<div id="calendar-error">',"<p>"+t+"</p>",'<button class="launch-enquiry">Ask about these dates <span class="side-arrow"></span></button>',"</div>"].join("");e("#calendar-legend").before(n),e(".launch-enquiry").click(function(){e(".retreat-detail__enquiry-window").addClass("show"),e(".retreat-detail__enquiry-window").scrollLock()})}function O(){var t=s.datepicker("getDate");if(t){var n=e.datepicker.formatDate(o,t).toUpperCase(),i=A.departureDates.filter(function(e){return e.deptdate.toUpperCase()===n})[0];if(i){var r=e("#bookingPetsCheck").is(":checked")?i.displaypricepets:i.displayprice,l=parseFloat(r).toFixed(2);if(i.displaydiscount&&0!==i.displaydiscount){var c=parseFloat(l)+parseFloat(i.displaydiscount);e("#newBookingWidgetPromoPrice").html('Your subtotal is <span class="line-through">'+a.currencySymbol+c.toFixed(2)+"</span> "+a.currencySymbol+l)}else e("#newBookingWidgetPromoPrice").html("Your subtotal is "+a.currencySymbol+l);e("#display-price-h").val(a.currencySymbol+l)}else e("#newBookingWidgetPromoPrice").html(L)}else e("#newBookingWidgetPromoPrice").html(L)}var A=this;A.arrivalDates=[],A.departureDates=[],A.departureDatesBeyond=[],A.checkInDatepicker=void 0,A.checkOutDatepicker=void 0,A.clear=_,A.clearCheckInDatepicker=D,A.clearCheckOutDatepicker=S,A.hideBookingError=I,A.hideCalendarError=T,A.getArrivalDates=M,A.getDepartureDates=x,A.getDepartureDatesBeyond=E,A.showBookingError=F,A.showCalendarError=q,A.updatePrice=O,function(){A.checkInDatepicker=new C(A,a),A.checkOutDatepicker=new w(A,a);var p=new Date,h=t.get("nret[start_date]"),f=t.get("nret[end_date]");A.getArrivalDates(p,function(){if(A.checkInDatepicker.refresh(),r.prop("disabled",!1),h&&f){var t=h.toLowerCase().split("-"),p=f.toLowerCase().split("-"),v=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"],g=v.indexOf(t[1]),k=v.indexOf(p[1]),b=new Date(t[2],g,t[0]),C=new Date(p[2],k,p[0]),w=e.datepicker.formatDate(n,b).toUpperCase();A.checkOutDatepicker.showLoader(),e.get("/api/v1/getoptdeparture/"+a.retreatId+"/"+w,function(t){if(A.checkOutDatepicker.hideLoader(),e("#initEnquiry").prop("disabled",!1),t.error)A.showBookingError("Error getting dates.");else{var n=e.datepicker.formatDate(o,C).toUpperCase(),a=t.data.filter(function(e){return e.deptdate===n})[0];if(a&&"A"===a.status)y(b,C);else{A.showBookingError("Sorry, your dates are not available."),r.datepicker("setDate",b);var p=e.datepicker.formatDate(i,b).toUpperCase();l.text(p),c.addClass("show"),r.parent().addClass("booking-error init-error"),s.datepicker("setDate",C);var h=e.datepicker.formatDate(i,C).toUpperCase();d.text(h),u.addClass("show"),s.parent().addClass("booking-error init-error"),m.removeClass("booking-error")}}})}else e("#initEnquiry").prop("disabled",!1)});var v=t.get("nret[guests]");if(v){var k=e('a[data-value="'+v+'"][data-input-target="bookingAdultCount"]'),b=k.text();e("#"+k.data("inputTarget")).val(b)}g()}();var L=e("#newBookingWidgetPromoPrice").html()},C=function(d,u){function p(){clearTimeout(S),e("#ui-datepicker-div .ui-datepicker-calendar").is(":visible")?(e(".ui-datepicker-prev:not(.ui-state-disabled), .ui-datepicker-next:not(.ui-state-disabled)").on("click.bookingwidget",function(){f()}),e(".clear-dates button, button.clear-dates").on("click",function(){d.clear()}),e(".ui-state-default").on("click",function(t){e(".ui-state-default").parent().removeClass("calendar-error");var n,o,i=e(this),a=new Date,r=i.text();e(".ui-datepicker-multi").length&&i.closest(".ui-datepicker-group-last").length?(n=D.displayedMonth>11?1:D.displayedMonth+1,o=D.displayedMonth>11?D.displayedYear+1:D.displayedYear):(n=D.displayedMonth,o=D.displayedYear),a.setFullYear(o,n-1,r),m(a)||(t.preventDefault(),t.stopPropagation(),e(this).parent().addClass("calendar-error"))})):S=setTimeout(p,10)}function h(){clearTimeout(M);var t=['<div id="calendar-legend">',"<ul>",'<li class="available"><div class="legend-icon"></div>&nbsp;Available</li>','<li class="check-in-only"><div class="legend-icon"></div>&nbsp;Check In Only</li>','<li class="unavailable"><div class="legend-icon"></div>&nbsp;Unavailable</li>','<li class="clear-dates"><button><div class="icon icon_close"></div>&nbsp;Clear Dates</button></li>',"</ul>","</div>"].join("");e("#ui-datepicker-div .ui-datepicker-calendar").is(":visible")?(e("#ui-datepicker-div").addClass("ui-datepicker-check-in").removeClass("ui-datepicker-check-out"),e("#calendar-legend").length||e("#ui-datepicker-div").append(t)):M=setTimeout(h,10)}function f(){if(window.innerWidth<769&&!e.contains(".filter-option-check-in","#ui-datepicker-div")){e("#ui-datepicker-div").detach().appendTo(".filter-option-check-in")}h(),p()}function v(t){if(!d.arrivalDates.length)return[!1,"",null];if(t<new Date)return[!1,"",null];var n=e.datepicker.formatDate(o,t).toUpperCase(),i=d.arrivalDates.filter(function(e){return e.caldate.toUpperCase()===n})[0];if(!i)return x&&4!==x.readyState||(x=d.getArrivalDates(t,function(){e("#initEnquiry").prop("disabled",!1),D.refresh()})),[!1,"",null];var a=r.datepicker("getDate"),l=s.datepicker("getDate"),c=i&&1===i.available&&i.valid_arrival,u="";if(i&&1===i.available&&!i.valid_arrival&&(u+=" fake-selectable"),c&&i.checkin_only&&(u+=" check-in-only"),a){t.getTime()===a.getTime()&&(u+=" check-in-date");var p=e.datepicker.formatDate(o,a).toUpperCase(),h=d.arrivalDates.filter(function(e){return e.caldate.toUpperCase()===p})[0];if(h){var f=h.min_stay,v=new Date(a);v.setDate(v.getDate()+f-1),t<=v&&t>a&&(u+=" included-in-minimum"),t.getTime()===v.getTime()&&(u+=" included-in-minimum-last")}}return l&&t.getTime()===l.getTime()&&(u+=" check-out-date"),a&&l&&t<l&&t>a&&(u+=" in-between"),[c,u.trim(),null]}function m(t){d.hideCalendarError();var n,i=e.datepicker.formatDate(o,t).toUpperCase(),a=d.arrivalDates.filter(function(e){return e.caldate.toUpperCase()===i})[0];if(a)if(a.available<=0)d.showCalendarError("Sorry, the date you have selected is not available."),n=!1;else if(a.valid_arrival){for(var r=a.min_stay,s=d.arrivalDates.indexOf(a),l=!0,c=1;c<r;c++){var u=d.arrivalDates[s+c];if(void 0===u||null===u||u.available<=0){l=!1;break}}l?n=!0:(d.showCalendarError("Sorry, some dates included in the "+r+" night minimum are not available."),n=!1)}else d.showCalendarError("Sorry, the day of week selected is not available for check in."),n=!1;else d.showCalendarError("Sorry, the date you have selected is not available."),n=!1;return n}function g(){r.parent().removeClass("booking-error init-error");var o=r.datepicker("getDate"),a=s.datepicker("getDate"),u=e.datepicker.formatDate(n,o).toUpperCase(),p=e.datepicker.formatDate(i,o).toUpperCase();l.text(p),c.addClass("show"),t.set("nret[start_date]",u),s.is(":disabled")&&s.prop("disabled",!1),s.datepicker("option","defaultDate",o),a||setTimeout(function(){s.datepicker("show")},250),d.clearCheckOutDatepicker(),d.getDepartureDates(o,function(){d.checkOutDatepicker.refresh()}),d.updatePrice()}function k(){var e=r.datepicker("getDate"),t=new Date;D.displayedMonth=e?e.getMonth()+1:t.getMonth()+1,D.displayedYear=e?e.getFullYear():t.getFullYear()}function y(){r.datepicker("setDate",null).datepicker("hide").blur(),l.text("Check In"),s.prop("disabled",!0).blur(),k()}function b(){clearInterval(E),e("#calendar-loader").remove()}function C(o){r.datepicker("setDate",o);var a=e.datepicker.formatDate(i,o).toUpperCase();l.text(a),c.addClass("show");var u=r.datepicker("getDate"),p=e.datepicker.formatDate(n,u).toUpperCase();t.set("nret[start_date]",p),s.is(":disabled")&&s.prop("disabled",!1),s.datepicker("option","defaultDate",u),d.clearCheckOutDatepicker(),d.getDepartureDates(u,function(){d.updatePrice()})}function w(){r.datepicker("refresh"),f()}function _(){clearInterval(E);E=setInterval(function(){e("#calendar-loader").length||e("#ui-datepicker-div").append('<div id="calendar-loader"></div>')},10)}var D=this;D.displayedMonth=void 0,D.displayedYear=void 0,D.clear=y,D.hideLoader=b,D.preloadDate=C,D.refresh=w,D.showLoader=_,function(){r.datepicker({dateFormat:r.data("dateFormat"),minDate:0,numberOfMonths:a,beforeShow:function(){k(),f()},beforeShowDay:v,onChangeMonthYear:function(e,t){D.displayedMonth=t,D.displayedYear=e},onSelect:g}),k()}();var S,M,x,E},w=function(l,c){function f(){clearTimeout(x),e("#ui-datepicker-div .ui-datepicker-calendar").is(":visible")?(e(".ui-datepicker-prev:not(.ui-state-disabled), .ui-datepicker-next:not(.ui-state-disabled)").on("click.bookingwidget",function(){m()}),e(".clear-dates button, button.clear-dates").on("click",function(){l.clear()}),e(".ui-state-default").on("click.bookingwidget",function(t){e(".ui-state-default").parent().removeClass("calendar-error");var n,o,i=e(this),a=new Date,r=i.text();e(".ui-datepicker-multi").length&&i.closest(".ui-datepicker-group-last").length?(n=M.displayedMonth>11?1:M.displayedMonth+1,o=M.displayedMonth>11?M.displayedYear+1:M.displayedYear):(n=M.displayedMonth,o=M.displayedYear),a.setFullYear(o,n-1,r),k(a,this)||(t.preventDefault(),t.stopPropagation(),e(this).parent().addClass("calendar-error"))}),window.innerWidth>=769&&e("#ui-datepicker-div tbody td").on("mouseenter",function(){if(!e(this).hasClass("ui-datepicker-other-month")){var t=r.datepicker("getDate"),n=s.datepicker("getDate");if(t&&!n){var o=e("#ui-datepicker-div tbody td").index(this),i=e("#ui-datepicker-div tbody td.check-in-date"),a=i.length?e("#ui-datepicker-div tbody td").index(i):0;e("#ui-datepicker-div tbody td").each(function(t,n){return!!(t<a||e(n).hasClass("check-in-date"))||!(t>=o)&&void e(n).addClass("hover-in-between")})}}}).on("mouseleave",function(){e("#ui-datepicker-div tbody td").removeClass("hover-in-between")})):x=setTimeout(f,10)}function v(){clearTimeout(E);var t=['<div id="calendar-legend">',"<ul>",'<li class="available"><div class="legend-icon"></div>&nbsp;Available</li>','<li class="check-out-only"><div class="legend-icon"></div>&nbsp;Check Out Only</li>','<li class="unavailable"><div class="legend-icon"></div>&nbsp;Unavailable</li>','<li class="clear-dates"><button><div class="icon icon_close"></div>&nbsp;Clear Dates</button></li>',"</ul>","</div>"].join("");e("#ui-datepicker-div .ui-datepicker-calendar").is(":visible")?(e("#ui-datepicker-div").removeClass("ui-datepicker-check-in").addClass("ui-datepicker-check-out"),e("#calendar-legend").length||e("#ui-datepicker-div").append(t)):E=setTimeout(v,10)}function m(){
if(window.innerWidth<769&&!e.contains(".filter-option-check-out","#ui-datepicker-div")){e("#ui-datepicker-div").detach().appendTo(".filter-option-check-out")}v(),f()}function g(t){if(!l.departureDates.length)return[!1,"",null];if(t<new Date)return[!1,"",null];var n=e.datepicker.formatDate(o,t).toUpperCase(),i=l.departureDates.filter(function(e){return e.deptdate.toUpperCase()===n})[0];if(!i){var a=l.departureDatesBeyond.filter(function(e){return e.deptdate.toUpperCase()===n})[0];if(!(a||I&&4!==I.readyState))return I=l.getDepartureDatesBeyond(t,function(){M.refresh()}),[!1,"",null];i=a}var c=r.datepicker("getDate"),d=s.datepicker("getDate"),u=i&&"A"===i.status,p=i&&i.available>0,h="";if(u?i.check_out_only&&(h+=" check-out-only"):p&&(i.check_out_only&&(h+=" check-out-only"),h+=" fake-selectable"),c){t.getTime()===c.getTime()&&(h+=" check-in-date");var f=e.datepicker.formatDate(o,c).toUpperCase(),v=l.arrivalDates.filter(function(e){return e.caldate.toUpperCase()===f})[0];if(v){var m=v.min_stay,g=new Date(c);g.setDate(g.getDate()+m-1),t<=g&&t>c&&(h+=" included-in-minimum"),t.getTime()===g.getTime()&&(h+=" included-in-minimum-last")}}return d&&t.getTime()===d.getTime()&&(h+=" check-out-date"),c&&d&&t<d&&t>c&&(h+=" in-between"),[u,h.trim(),null]}function k(t,n){l.hideCalendarError();var i,a=e.datepicker.formatDate(o,t).toUpperCase(),s=l.departureDates.filter(function(e){return e.deptdate.toUpperCase()===a})[0];if(s)switch(s.status){case"A":i=!0;break;case"B":l.showCalendarError("Sorry, select a date after your check in date."),i=!1;break;case"M":var c=r.datepicker("getDate"),d=e.datepicker.formatDate(o,c).toUpperCase(),u=l.arrivalDates.filter(function(e){return e.caldate.toUpperCase()===d})[0];if(u){var p=u.min_stay;l.showCalendarError("Sorry, there is a "+p+" night minimum for the date you selected.")}else l.showCalendarError("Sorry, there is a night minimum for the date you selected.");i=!1;break;case"D":l.showCalendarError("Sorry, the day of week selected is not available for check out."),i=!1;break;case"U":default:l.showCalendarError("Sorry, the date you selected is not available."),i=!1}else l.showCalendarError("Sorry, the date you selected is not available."),i=!1;return i}function y(){s.parent().removeClass("booking-error init-error");var o=r.datepicker("getDate"),a=s.datepicker("getDate"),f=e.datepicker.formatDate(n,o).toUpperCase(),v=e.datepicker.formatDate(n,a).toUpperCase(),m=e.datepicker.formatDate(i,a).toUpperCase();if(d.text(m),u.addClass("show"),t.set("nret[end_date]",v),o&&a){var g=Math.abs(a.getTime()-o.getTime()),k=Math.round(g/864e5),y=p.val()?parseInt(p.val()):0,b=h.val()?parseInt(h.val()):0,C=y+b,w=e("#bookingPets").val();e("#booking-nights").length&&e("#booking-nights").val(k),t.set("nret[nights]",k),e.get("/api/v1/enquiry/"+c.nodeId+"/"+f+"/"+k+"/"+C+"/"+w)}l.updatePrice()}function b(){var e=s.datepicker("getDate"),t=s.datepicker("option","defaultDate"),n=new Date;e?(M.displayedMonth=e.getMonth()+1,M.displayedYear=e.getFullYear()):(M.displayedMonth=t?t.getMonth()+1:n.getMonth()+1,M.displayedYear=t?t.getFullYear():n.getFullYear())}function C(){r.blur(),s.datepicker("setDate",null).datepicker("hide").blur(),d.text("Select Date"),b()}function w(){clearInterval(T),e("#calendar-loader").remove()}function _(o){s.datepicker("setDate",o);var a=e.datepicker.formatDate(i,o).toUpperCase();d.text(a),u.addClass("show");var c=r.datepicker("getDate"),p=s.datepicker("getDate"),h=e.datepicker.formatDate(n,p).toUpperCase();if(t.set("nret[end_date]",h),c&&p){var f=Math.abs(p.getTime()-c.getTime()),v=Math.round(f/864e5);e("#booking-nights").length&&e("#booking-nights").val(v),t.set("nret[nights]",v)}l.updatePrice()}function D(){s.datepicker("refresh"),m()}function S(){clearInterval(T);T=setInterval(function(){e("#calendar-loader").length||e("#ui-datepicker-div").append('<div id="calendar-loader"></div>')},10)}var M=this;M.displayedMonth=void 0,M.displayedYear=void 0,M.clear=C,M.hideLoader=w,M.preloadDate=_,M.refresh=D,M.showLoader=S,function(){s.datepicker({dateFormat:s.data("dateFormat"),minDate:0,numberOfMonths:a,beforeShow:function(){b(),m()},beforeShowDay:g,onChangeMonthYear:function(e,t){M.displayedMonth=t,M.displayedYear=e},onSelect:y})}();var x,E,I,T};r.length&&s.length&&new b(y)}(jQuery,Cookies);var nret=nret||{};!function(e,t){var n;e("#contact-form").submit(function(o){o.preventDefault();var i=e(this).serializeArray(),a=e("#contact-form input[type=submit]").val();e("#contact-form input[type=submit]").val("Sending..."),e.ajax({type:"POST",url:"/themes/nretreats/templates/contact-form.php",data:i,success:function(o){JSON.parse(o).success?e("#contact-form input[type=submit]").val("Sent"):e("#contact-form input[type=submit]").val("Error, Try Again"),t.clearTimeout(n),n=setTimeout(function(){e("#contact-form input[type=submit]").val(a)},5e3)}})})}(jQuery,window);var nret=nret||{};!function(e){nret.cookies={setupJournalCookies:function(e,t,n,o){Cookies.set("journal_list_type",e),Cookies.set("journal_list_location",t),Cookies.set("journal_list_environment",n),Cookies.set("journal_list_experiences",o)},setLocationCookiesFromHome:function(){e("a[data-home-location]").on("click",function(){var t=e(this).attr("data-home-location");Cookies.set("destination_location",t),e("a[data-home-location]").not(e(this)).removeClass("filter-selected"),e(this).addClass("filter-selected"),e("#initHomeSearch").attr("href","/node/"+t),e(".destination.home__search__choice").html(e(this).html()),e(".global-nav__destinations.home__search__dropdown").removeClass("show"),nret.home.changeStartBtnColorOnSelection()})},setCountryCookies:function(){e("a[data-country-selection]").on("click",function(){var t=e(this).attr("data-country-selection");Cookies.set("country_selection",t)})},setFirstTimeCookie:function(){Cookies.get("first_session")?nret.home.closeNavBanner():Cookies.set("first_session",!1)},init:function(){nret.cookies.setCountryCookies(),nret.cookies.setLocationCookiesFromHome(),nret.cookies.setFirstTimeCookie()}},jQuery(document).ready(function(){nret.cookies.init()})}(jQuery);var nret=nret||{};!function(e){var t,n=0;nret.drag={initDraggable:function(){e(".scroll-el").draggable({axis:"x"},{containment:".scroll-el-wrapper",scroll:!1},{drag:function(t,o){n=o.position.left,nret.drag.slideElements(e(this))}}),t=e(".scroll-el-wrapper").innerWidth()-25},resizeScreen:function(){window.onresize=function(){nret.drag.initDraggable()}},initSlide:function(){e(window).innerWidth()>767&&e("body").hasClass("desktop")&&window.requestAnimationFrame(nret.drag.slideElements)},slideElements:function(e){var o=e.parents(".scroll-drag").prev(),i=n/t*100,a=o[0].scrollWidth-o[0].clientWidth;o[0].scrollLeft=a*(.01*i)},init:function(){nret.drag.initDraggable()}},jQuery(document).ready(function(){e(".scroll-drag").length>0&&(nret.drag.init(),nret.drag.resizeScreen())})}(jQuery);var nret=nret||{};!function(e){var t=window.innerWidth<769?1:2;nret.enquiry={createCalendar:function(){e("#retreatEnquiryCheckIn").on("click",function(){setTimeout(function(){nret.enquiry.els.enquiryCheckIn.datepicker("refresh")},10)}),nret.enquiry.els.enquiryCheckIn.prop("disabled",!1).datepicker({minDate:new Date,numberOfMonths:t,dateFormat:"M dd yy",beforeShow:function(){if(window.innerWidth<769&&!e.contains(".enquiry-check-in","#ui-datepicker-div")){e("#ui-datepicker-div").detach().appendTo(".enquiry-check-in")}},onSelect:function(){var t=nret.enquiry.els.enquiryCheckIn.datepicker("getDate"),n=t;e("#retreatEnquiryCheckOut").datepicker("option","minDate",n).datepicker("setDate",t),setTimeout(function(){e("#retreatEnquiryCheckOut").prop("disabled",!1).datepicker("show")},100)}}),nret.enquiry.els.enquiryCheckOut.prop("disabled",!1).datepicker({minDate:new Date,numberOfMonths:t,dateFormat:"M dd yy",beforeShow:function(){if(window.innerWidth<769&&!e.contains(".enquiry-check-out","#ui-datepicker-div")){e("#ui-datepicker-div").detach().appendTo(".enquiry-check-out")}}})},collectAndSendForm:function(){var t;e("#retreatEnquiryForm").submit(function(n){n.preventDefault();var o=e(this).serializeArray(),i=e("#retreatEnquiryForm input[type=submit]").val(),a=e(".acquisition__thankyou");e("#retreatEnquiryForm input[type=submit]").val("Sending..."),e.ajax({type:"POST",url:"/themes/nretreats/templates/retreat-enquiry.php",data:o,success:function(n){'{"success": true}'==n?(e("#retreatEnquiryForm input[type=submit]").val("Sent"),a.addClass("show")):e("#retreatEnquiryForm input[type=submit]").val("Error, Try Again"),window.clearTimeout(t),t=setTimeout(function(){e("#retreatEnquiryForm input[type=submit]").val(i),nret.enquiry.els.retreatWindow.removeClass("show"),nret.enquiry.els.retreatWindow.scrollRelease()},1500)}})})},enquiryInteractions:function(){e(".enquiry__close").on("click",function(){nret.enquiry.els.retreatWindow.removeClass("show"),nret.enquiry.els.retreatWindow.scrollRelease()}),e("#initEnquiry").on("click",function(e){e.preventDefault(),nret.enquiry.launchEnquiry()})},launchEnquiry:function(){var t=e("#check-in").datepicker("getDate"),n=e("#check-out").datepicker("getDate");!e("#retreat-search").length>0&&(nret.enquiry.els.enquiryCheckIn.datepicker("setDate",t),nret.enquiry.els.enquiryCheckOut.datepicker("setDate",n)),nret.enquiry.els.retreatWindow.addClass("show"),nret.enquiry.els.retreatWindow.scrollLock()},init:function(){nret.enquiry.els={retreatWindow:e(".retreat-detail__enquiry-window"),enquiryCheckIn:e("#retreatEnquiryCheckIn"),enquiryCheckOut:e("#retreatEnquiryCheckOut")},nret.enquiry.createCalendar(),nret.enquiry.collectAndSendForm(),nret.enquiry.enquiryInteractions()}},e(document).ready(function(){nret.enquiry.init()})}(jQuery);var nret=nret||{};!function(e){nret.explorer={openExplorerModal:function(t){e(".about__explorer-modal-"+t).eq(0).velocity({opacity:1},{display:"flex"}),e("content-start").addClass("quickview-blur"),e(".about__explorer-modal").scrollLock(),e(".about__explorer-modal").addClass("open")},closeExplorerModal:function(){e(".about__explorer-modal").velocity({opacity:0},{display:"none"}),e(".content-start").removeClass("quickview-blur"),e(".about__explorer-modal").scrollRelease(),e(".about__explorer-modal").removeClass("open")},explorerModalEvents:function(){e(".openExplorerModal").on("click",function(t){var n=e(this).attr("data-explorer-modal");nret.explorer.openExplorerModal(n)}),e(".about__explorer-modal__close").on("click",function(){nret.explorer.closeExplorerModal()})},init:function(){nret.explorer.explorerModalEvents()}},jQuery(document).ready(function(){nret.explorer.init()})}(jQuery);var nret=nret||{};!function(e){nret.filters={filterElementsEvent:function(){var t=e(".filter-me");e(".filter-choice-init").on("click",function(){e(this).hasClass("fresh")&&(t.addClass("hide"),e(".filter-choice-init").removeClass("fresh")),nret.filters.filterElements(),nret.destinationListing.setResultsNum()})},filterElements:function(){var t=null,n=[];e(".guest-list .filter-selected")[0]&&(t=e(".guest-list .filter-selected").attr("data-filter-choice")),e(".region-list .filter-selected").each(function(){n.push(e(this).attr("data-filter-choice"))}),e(".filter-me").each(function(){var o=e(this),i=!1,a=!1;t&&!o.hasClass(t)||(a=!0),0===n.length?i=!0:n.forEach(function(e){o.hasClass(e)&&(i=!0)}),i&&a?o.removeClass("hide"):o.addClass("hide")})},clearMoreFilters:function(){e("#clearMoreFilters").on("click",function(){e(".filter__more__block").find('input[type="checkbox"]').each(function(){e(this).prop("checked",!1)}),e(".filter__more__block").find('input[type="radio"]').each(function(){e(this).prop("checked",!1)}),e("#more-label").text("More Filters"),Cookies.remove("retreat_list[bedrooms]"),Cookies.remove("retreat_list[beds]"),Cookies.remove("retreat_list[bathrooms]"),e("input[data-more-filter-amenities]").each(function(e,t){Cookies.remove("retreat_list[amenities]["+e+"]")}),e("a[data-more-filter-area]").each(function(e,t){Cookies.remove("retreat_list[subarea]["+e+"]")})})},init:function(){nret.filters.filterElementsEvent(),nret.filters.clearMoreFilters()}},jQuery(document).ready(function(){nret.filters.init()})}(jQuery);var nret=nret||{};!function(e){nret.footer={openNewsletter:function(){e("footer").find("#openNewsletter").on("click",function(){e(".footer__newsletter-signup").velocity({maxHeight:600},{duration:500}),e(".footer__newsletter-signup").find(".wrapper").velocity({opacity:1},{duration:800},"linear")})},closeNewsletter:function(){e(".footer__newsletter-signup__close").on("click",function(){e(".footer__newsletter-signup").velocity({maxHeight:0},{duration:500}),e(".footer__newsletter-signup").find(".wrapper").velocity({opacity:0})})},phoneFix:function(){if(!e("body").hasClass("device-phone")){var t=e(".footer-nav__tel"),n=t.html();t.replaceWith('<span class="footer-nav__tel">'+n+"</span>")}},init:function(){nret.footer.phoneFix(),nret.footer.openNewsletter(),nret.footer.closeNewsletter()}},jQuery(document).ready(function(){nret.footer.init()})}(jQuery);var nret=nret||{};!function(e,t){nret.header={mblListen:function(){e(".mbl-btn-nav").on("click touchstart",function(){var t=e(this);t.toggleClass("open");var n=t.find("span:nth-child(1)"),o=t.find("span:nth-child(2)"),i=t.find("span:nth-child(3)"),a=t.find("span:nth-child(4)"),r=e(".global-nav__right"),s=(e(".global-nav .navbar-left"),e(".global-nav .navbar-right"));return t.hasClass("open")?(n.velocity({rotateZ:"405deg",translateY:"3px",translateX:"3px",backgroundColor:"#FFF"},{duration:200,easing:[0,-.01,.1,.99]}),o.velocity({opacity:0},{duration:100}),i.velocity({rotateZ:"-405deg",translateX:"2.2px",translateY:"-3px",backgroundColor:"#FFF"},{duration:200,easing:[0,-.01,.1,.99]}),a.velocity({height:"50px"},{duration:200,easing:[0,-.01,0,.99]}),r.velocity({translateY:"0%"},{duration:200,easing:[.77,.5,.59,.9]}),s.velocity("transition.slideLeftIn",{stagger:50,duration:70,delay:150}),s.velocity("transition.slideLeftIn",{stagger:50,duration:70,delay:150})):(n.velocity({rotateZ:"0deg",translateY:"0px",translateX:"0px",backgroundColor:"#312f3c"},{duration:200,easing:[0,-.01,.1,.99]}),o.velocity({opacity:1},{duration:200}),i.velocity({rotateZ:"0deg",translateX:"0px",translateY:"0px",backgroundColor:"#312f3c"},{duration:200,easing:[0,-.01,.1,.99]}),a.velocity({height:"0px"},{duration:200,easing:[0,-.01,0,.99]}),r.velocity({translateY:"-100%"},{duration:200,easing:[.77,.5,.59,.9],complete:function(){r.removeAttr("style"),e(".mobile-destination_subnav").removeClass("show")}})),!1}),e(".mbl-btn-search").on("click touchstart",function(){e(".mbl-btn-nav").hasClass("open")&&e(".mbl-btn-nav").trigger("click");var t=e(this);t.toggleClass("open");var n=e(".mbl-search-background"),o=t.find("span:nth-child(1)"),i=t.find("span:nth-child(3)");return t.hasClass("open")?(n.velocity({height:"50px"},{duration:200,easing:[0,-.01,0,.99]}),o.velocity({opacity:1,rotateZ:"405deg",translateY:"3px",translateX:"3px",backgroundColor:"#FFF"},{duration:200,easing:[0,-.01,.1,.99]}),i.velocity({opacity:1,rotateZ:"-405deg",translateX:"2.2px",translateY:"-3px",backgroundColor:"#FFF"},{duration:200,easing:[0,-.01,.1,.99]})):(n.velocity({height:"0px"},{duration:200,easing:[0,-.01,0,.99]}),o.velocity({opacity:0,rotateZ:"0deg",translateY:"0px",translateX:"0px",backgroundColor:"#312f3c"},{duration:200,easing:[0,-.01,.1,.99]}),i.velocity({opacity:0,rotateZ:"0deg",translateX:"0px",translateY:"0px",backgroundColor:"#312f3c"},{duration:200,easing:[0,-.01,.1,.99],complete:function(){}}),nret.header.mblSearch.destroy()),!1}),e(".initMobileSearchDates").on("click",function(){e(".mbl-btn-nav").hasClass("open")&&e(".mbl-btn-nav").trigger("click");var t=e(".mbl-btn-search");t.toggleClass("open");var n=e(".mbl-search-background"),o=t.find("span:nth-child(1)"),i=t.find("span:nth-child(3)");return t.hasClass("open")?(n.velocity({height:"50px"},{duration:200,easing:[0,-.01,0,.99]}),o.velocity({opacity:1,rotateZ:"405deg",translateY:"3px",translateX:"3px",backgroundColor:"#FFF"},{duration:200,easing:[0,-.01,.1,.99]}),i.velocity({opacity:1,rotateZ:"-405deg",translateX:"2.2px",translateY:"-3px",backgroundColor:"#FFF"},{duration:200,easing:[0,-.01,.1,.99]}),nret.header.mblSearch.build()):(n.velocity({height:"0px"},{duration:200,easing:[0,-.01,0,.99]}),o.velocity({opacity:0,rotateZ:"0deg",translateY:"0px",translateX:"0px",backgroundColor:"#312f3c"},{duration:200,easing:[0,-.01,.1,.99]}),i.velocity({opacity:0,rotateZ:"0deg",translateX:"0px",translateY:"0px",backgroundColor:"#312f3c"},{duration:200,easing:[0,-.01,.1,.99],complete:function(){}}),nret.header.mblSearch.destroy()),e("nav.global-nav .mbl-search-menu .options a.date").trigger("click"),!1})},mblCheckCookies:function(){var n={};n.checkIn=t.get("nret[start_date]"),n.checkOut=t.get("nret[end_date]"),n.guests=t.get("nret[guests]"),n.bedrooms=t.get("retreat_list[bedrooms]"),n.beds=t.get("retreat_list[beds]"),n.bathrooms=t.get("retreat_list[bathrooms]"),n.subarea=t.get("retreat_list[subarea][0]"),n.amenities=t.get("retreat_list[amenities][0]"),_.each(n,function(t,n){if(t){e(".select-box."+n).find(".entry").html(t)}})},mblSearch:{build:function(){var t=e("#mbl-search").html();t=e(t),t.find(".destinationFilterRefresh").on("click",function(){var e=window.location.href.split("#")[0],t=e.split("?")[0];window.location.href=t+"?filterApplied=true",window.location.reload()}),e(".global-nav").append(t),nret.header.mblCheckCookies(),setTimeout(function(){nret.destinationDetail.clearFilters()},800),e(".mbl-search-menu").velocity({translateY:"0%"},{duration:400,easing:[.77,.5,.59,.9]}),nret.header.mblSearch.applyListeners(),nret.header.initExplorePage()},applyListeners:function(){var n=e(".mbl-search-menu .options a");n.on("click",function(){var t=e(this);if(t.hasClass("navigate"))return window.location=t.attr("href"),!1;if(t.hasClass("active"))return!1;var o=t.attr("class");return n.removeClass("active"),t.addClass("active"),e(".mbl-search-menu section").removeClass("active"),e(".mbl-search-menu section."+o).addClass("active"),!1}),e(".mbl-search-menu select").on("change",function(){var n=e(this),o=n.find("option:selected").val();n.hasClass("guests")&&t.set("nret[guests]",o),n.hasClass("bedrooms")&&t.set("retreat_list[bedrooms]",o),n.hasClass("beds")&&t.set("retreat_list[beds]",o),n.hasClass("bathrooms")&&t.set("retreat_list[bathrooms]",o),n.hasClass("subarea")&&t.set("retreat_list[subarea][0]",o),n.hasClass("amenities")&&t.set("retreat_list[amenities][0]",o),n.parent(".select-box").find(".entry").text(n.find("option:selected").val()),n.hasClass("location")&&(e(".start-exploring.explore").attr("href","/node/"+o),e(".mbl-search-menu .select-box.loc").find(".entry").html(e(".mbl-search-menu select.location").find("option:selected").length))}),e(".mbl-search-menu .select-box.loc").on("click",function(){var t=e(this);e(".mbl-search-menu .select-box.loc").removeClass("active"),t.addClass("active")}),e(".mbl-search-menu .select-box.cal").on("click",function(){var n=e(this);e(".mbl-search-menu .select-box.cal").removeClass("active"),n.addClass("active"),n.find(".calendar").datepicker({minDate:new Date,onSelect:function(){n.removeClass("active");var o=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],i=n.find(".calendar").datepicker("getDate"),a=o[i.getMonth()]+" "+i.getDate();n.find(".entry").text(" "+a);var r=e(".calendar.checkIn").datepicker("getDate"),s=e(".calendar.checkOut").datepicker("getDate");if(n.hasClass("checkIn")){var l=e.datepicker.formatDate("dd-M-yy",r).toUpperCase();t.set("nret[start_date]",l),e(".calendar.checkOut").datepicker("setDate",r)}if(n.hasClass("checkOut")){var c=e.datepicker.formatDate("dd-M-yy",s).toUpperCase();e(".calendar.checkOut").datepicker("setDate",r),t.set("nret[end_date]",c);var d=e(".calendar.checkIn").datepicker("getDate").getTime(),u=e(".calendar.checkOut").datepicker("getDate").getTime(),p=Math.round(Math.abs((d-u)/864e5));t.set("nret[nights]",p)}},defaultDate:n.hasClass("checkOut")&&e(".calendar.checkIn").datepicker("getDate")?e(".calendar.checkIn").datepicker("getDate"):null})})},destroy:function(){e(".mbl-search-menu-title").remove();var t=e(".mbl-search-menu");t.velocity({translateY:"-100%"},{duration:200,easing:[.77,.5,.59,.9],complete:function(){t.remove()}})}},phoneFix:function(){if(!e("body").hasClass("device-phone")){var t=e(".global-nav__tel"),n=t.html();t.replaceWith('<span class="global-nav__tel">'+n+"</span>")}},openDestinationlistInNav:function(){var t=e("#main-left-menu").find('a[href="/destination"]');t.addClass("doNotClose"),t.on("click",function(t){t.preventDefault(),e("nav.global-nav").find(".global-nav__destinations").toggleClass("show")})},toggleDestinationListOnSelection:function(){e("a[data-opendestinationlist]").on("click",function(){var t=e(this).data("opendestinationlist"),n=e(this).closest(".global-nav__destinations__region").next(".global-nav__destinations__destination-list-wrapper").find("."+t),o=e(this).closest(".global-nav__destinations__region").next(".global-nav__destinations__destination-list-wrapper").find(".global-nav__destination-list");e(this).hasClass("active")||(e(this).parent().siblings().find("a[data-opendestinationlist]").removeClass("active"),e(this).addClass("active")),n.hasClass("show")||(o.not(n).removeClass("show"),n.addClass("show"))})},checkMenuHighlight:function(){null!==window.location.pathname.match(/destination/g)&&e("#main-left-menu li.first").addClass("active")},showMobileDestinationSubnav:function(){e(".mobile-destination_subnav").addClass("show")},hideMobileDestinationSubnav:function(){e(".mobile-destination_subnav").removeClass("show"),e(".global-nav__right #main-left-menu li").velocity("transition.slideLeftIn",{stagger:50,duration:70,delay:150}),e(".global-nav__right #main-right-menu li").velocity("transition.slideLeftIn",{stagger:50,duration:70,delay:150})},globalMessageListener:function(){var t=e("#global-message");t[0]&&t.on("click",function(n){var o=e(n.target);if(o.hasClass("modal")||o.hasClass("global-message-close"))return n.preventDefault(),t.remove(),!1})},bookNowSearchOpenEvent:function(){nret.header.els.bookBtn.on("click",function(){nret.header.openBookNowSearch()})},bookNowSearchCloseEvent:function(){nret.header.els.closeBookBtn.on("click",function(){nret.header.closeBookNowSearch()})},openBookNowSearch:function(){e("#retreat-search").length>0?e(".scroll-to-search").velocity("scroll",{duration:600,offset:-140,easing:"ease-in-out"}):e("body").hasClass("home-page")?e(".scroll-to-search").velocity("scroll",{duration:600,offset:-330,easing:"ease-in-out"}):nret.header.els.retreatSearch.velocity({opacity:1},{display:"flex"}),nret.header.els.retreatSearch.addClass("show")},closeBookNowSearch:function(){nret.header.els.retreatSearch.velocity({opacity:0},{display:"none"}),nret.header.els.retreatSearch.removeClass("show")},initExplorePage:function(){var n,o,i,a,r,s,l,c,d,u,p,h,f,v,m,g=[],k=e("[data-more-filter-amenities]"),y=e(".destination-label"),b=e(".checkin-label"),C=e(".checkout-label"),w=e(".bedroom-label");e(".initHomeRetreatReset").on("click",function(n){n.preventDefault(),e(".global-nav__destinations").find("input:checked").removeAttr("checked").change(),t.set("nret[location_id]",""),e(".bedrooms.home__search__choice, #bedroom-label").text("Bedrooms"),t.set("retreat_list[bedrooms]",""),e("body").hasClass("home-page")?(e(".checkin-sublabel, .checkout-sublabel").css({opacity:0}),e.datepicker._clearDate("#bookingCheckIn"),e.datepicker._clearDate("#bookingCheckOut")):(e.datepicker._clearDate("#bookingCheckInNav"),e.datepicker._clearDate("#bookingCheckOutNav"),e(".checkin-sublabel, .checkout-sublabel").removeClass("show"))}),e(".initHomeRetreatSearch").on("click",function(_){_.preventDefault(),o=[],v=!0,nret.destinationDetail.setCookiesBedrooms(),e(this).hasClass("start-exploring")?(o=e(".location").val(),console.log(o)):(n=e(".global-nav__destinations__destination-list-wrapper").find(".custom-check-input"),n.each(function(){e(this).is(":checked")&&e(this).prop("disabled")===!1&&o.push(e(this).attr("data-home-location"))})),e("#retreat-search").length&&(nret.destinationDetail.setCookiesGuest(),nret.destinationDetail.setCookiesBed(),nret.destinationDetail.setCookiesBathroom(),nret.destinationDetail.setCookiesArea(),nret.destinationDetail.setCookiesAmenities()),null!==o.length&&(a=o.join(",")),k.each(function(e){var n=t.get("retreat_list[amenities]["+e+"]");n&&g.push(n)}),r=t.get("nret[start_date]"),s=t.get("nret[nights]"),l=t.get("nret[guests]")||0,c=t.get("retreat_list[bedrooms]")||0,u=t.get("retreat_list[beds]")||0,d=t.get("retreat_list[bathrooms]")||0,p="both",h="all",f=g.length>0?g.join(","):"all",m="all",i="/explore/"+a+"/"+r+"/"+s+"/"+l+"/"+c+"/"+u+"/"+d+"/"+p+"/"+h+"/"+f+"/"+m,t.set("nret[location_id]",a),e("#home").length&&(y.removeClass("error"),b.removeClass("error"),C.removeClass("error"),w.removeClass("error"),0===o.length&&(y.addClass("error"),v=!1),void 0===r&&(b.addClass("error"),v=!1),void 0===s&&(C.addClass("error"),v=!1)),v===!0&&(location=i)})},init:function(){nret.header.els={bookBtn:e("#openBookNowSearch"),closeBookBtn:e("#closeBookInNav"),retreatSearch:e(".global-nav__retreat_search")},nret.header.mblListen(),nret.header.phoneFix(),nret.header.openDestinationlistInNav(),nret.header.toggleDestinationListOnSelection(),nret.header.initExplorePage(),nret.header.checkMenuHighlight(),nret.header.globalMessageListener(),nret.header.bookNowSearchOpenEvent(),nret.header.bookNowSearchCloseEvent()}},e(document).ready(function(){nret.header.init()})}(jQuery,Cookies);var nret=nret||{};!function(e){nret.imageGallery={initImageGallery:function(){e(".image-gallery").length>0&&(e(".image-gallery").slick({arrows:!1,infinite:!0,slidesToShow:1,asNavFor:".image-gallery-photographer",variableWidth:!0}),e(".image-gallery-photographer").slick({slidesToShow:1,slidesToScroll:1,arrows:!1,fade:!0,asNavFor:".image-gallery"}))},initBasicCarousel:function(){e(".js-carousel").slick({arrows:!1,infinite:!0,slidesToShow:1,waitForAnimate:!1,dots:!0})},basicCarouselControls:function(){var t=e(".js-carousel-prev"),n=e(".js-carousel-next"),o=e(".js-carousel-parent"),i=e(".js-carousel");n.on("click",function(){e(this).closest(o).find(i).slick("slickNext")}),t.on("click",function(){e(this).closest(o).find(i).slick("slickPrev")})},imageGalleryControls:function(){e(".image-gallery").length>0&&(e(".image-gallery__navigation-left").on("click",function(){e(this).closest(".image-gallery__parent").find(".image-gallery").slick("slickPrev")}),e(".image-gallery__navigation-right").on("click",function(){e(this).closest(".image-gallery__parent").find(".image-gallery").slick("slickNext")}))},initRoomTypeCarousel:function(){e(".room-type-detail__multi__carousel").length>0&&e(".room-type-detail__multi__carousel").slick({arrows:!1,infinite:!0,waitForAnimate:!1})},roomTypeCarouselFilterControls:function(){function t(){n=e(this).attr("data-room-index"),e(this).hasClass("active")||(e(".room-type-detail__multi__header__filter__choice").removeClass("active"),e(this).addClass("active")),nret.imageGallery.roomTypeCarouselGoToIndex(n)}var n;e(".room-type-detail__multi__header__filter").length>0&&e(".room-type-detail__multi__header__filter__choice").on("click",t)},roomTypeCarouselGoToIndex:function(t){e(".room-type-detail__multi__carousel").slick("slickGoTo",t)},responsiveImageGallery:function(){var t=e(".image-gallery-mobile");t&&(window.onresize=function(){window.innerWidth<=768&&!t.hasClass("slick-initialized")?nret.imageGallery.mobileOffersRowGallery():window.innerWidth>=769&&t.hasClass("slick-initialized")&&t.slick("destroy")}),window.innerWidth<=768&&nret.imageGallery.mobileOffersRowGallery()},mobileOffersRowGallery:function(){e(".image-gallery-mobile").hasClass("explore-team-row"),e(".image-gallery-mobile").slick({arrows:!1,infinite:!0,dots:!0,slidesToShow:1,waitForAnimate:!1})},init:function(){nret.imageGallery.initImageGallery(),nret.imageGallery.imageGalleryControls(),nret.imageGallery.initRoomTypeCarousel(),nret.imageGallery.initBasicCarousel(),nret.imageGallery.basicCarouselControls(),nret.imageGallery.responsiveImageGallery(),nret.imageGallery.roomTypeCarouselFilterControls()}},jQuery(document).ready(function(){nret.imageGallery.init()})}(jQuery);var nret=nret||{};!function(e){nret.maps={mapController:function(){var t,n=[],o=new google.maps.MarkerImage("/themes/nretreats/images/pin_alt.png");return{updateMarker:function(e){t&&t.setIcon(o),t=e,e.setIcon()},push:function(e){n.push(e)},setHightlightContainer:function(t){for(var i=0;i<n.length;i++)n[i].setIcon(o),function(o){n[i].addListener("click",function(){e(e("."+t).children()[o]).find("h4").trigger("click")})}(i);e("."+t).children().on("click",function(t){this.updateMarker(n[e(t.currentTarget).index()])}.bind(this)),e(function(){e(e("."+t).children()[0]).find("h4").trigger("click")})},setBounds:function(e){for(var t=new google.maps.LatLngBounds,o=0;o<n.length;o++)t.extend(n[o].getPosition());e.fitBounds(t),zoomChangeBoundsListener=google.maps.event.addListenerOnce(e,"bounds_changed",function(e){this.getZoom()&&this.setZoom(this.getZoom()-2)}),setTimeout(function(){google.maps.event.removeListener(zoomChangeBoundsListener)},2e3)}}},initMap:function(n,o,a,r,s,l){function c(){for(i=0;i<h.length;i++)h[i].setMap(m)}var d,l=l,u=null,p=null,h=[],f=[];void 0===l&&(l=8);var v=[{featureType:"all",stylers:[{saturation:-80}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{hue:"#e4e4e4"},{saturation:50}]},{featureType:"poi.business",elementType:"labels",stylers:[{visibility:"off"}]}],m=new google.maps.Map(a,{center:{lat:n,lng:o},scrollwheel:!1,styles:v,disableDefaultUI:!1,zoom:l}),g=new this.mapController;if(r.length>0){var k=e(".map-card__container"),y=0;r.forEach(function(t){d={lat:parseFloat(t[0]),lng:parseFloat(t[1])},t[2]&&(u=t[2]),t[3]&&(p=String(t[3]));var n=new google.maps.Marker({position:d,map:m,id:u,region:p,animation:google.maps.Animation.DROP});g.push(n),h.push(n),google.maps.event.addListener(n,"click",function(){k.removeClass("show"),k.each(function(){e(this).data("destinationcard")==n.id&&e(this).addClass("show")})}),y++}),e(".region-list").find(".filter-choice-init").on("click",function(){var n=e(this).data("filter-choice");if(jQuery.inArray(n,f)!==-1)for(var o=f.length-1;o>=0;o--)f[o]===n&&f.splice(o,1);else f.push(n);for(o=0;o<h.length;o++){var i=h[o].region;for(h[o].setMap(null),t=0;t<f.length;t++)i===f[t]&&h[o].setMap(m)}window.setTimeout(function(){0===e(".region-list").find(".filter-selected").length&&c()},100)}),e(".destination-listing__filter-clear").on("click",function(){c()}),s&&(g.setHightlightContainer(s),g.setBounds(m))}},getMapElements:function(t){(t||e(".map")).each(function(){var t,n=void 0,o=e(this),i=this,a=o.attr("data-lat"),r=Number(a),s=o.attr("data-lng"),l=Number(s),c=[],d=o.data("highlightonclickcontainer");if(o.attr("data-zoom")&&(n=parseInt(o.attr("data-zoom"))),t="destinationListMap"===o.attr("id")?4:2,o.data("markers")){var u=e(this).data("markers");"destinationListMap"===o.attr("id")&&(u=u.replace("[","").replace("]","").split(","));for(var p=0;p<u.length;p++){var h=u.splice(0,t);u.length==t&&c.push(u),c.push(h)}}nret.maps.initMap(r,l,i,c,d,n)})},runMapInOrder:function(){nret.maps.getMapElements()}}}(jQuery);var nret=nret||{};!function(e){nret.newsletter={submitNewsletterForm:function(){e(".newsletter-email").on("submit",function(t){t.preventDefault();var n=e(this),o=n.serialize();e.ajax({url:"/api/v1/newsletter",type:"POST",data:o,success:function(e){n.velocity({opacity:0}),n.siblings(".newsletter-error").hasClass("show")&&n.siblings(".newsletter-error").removeClass("show"),n.siblings(".newsletter-thankyou").addClass("show")},error:function(e){n.siblings(".newsletter-error").addClass("show")}})})},init:function(){nret.newsletter.submitNewsletterForm()}},jQuery(document).ready(function(){nret.newsletter.init()})}(jQuery);var nret=nret||{};!function(e){var t,n=!1;nret.quickView={openQuickView:function(t){var o=t.data("quickview-id"),i=e(e("#quickview-modal-"+o).html()),a=e(i.find(".quickview-map"))
;this.renderQuickView(i,a),e(".video__bg").length&&(n=e(".video__bg"),n.hide()),i.velocity({opacity:1},{display:"flex"}),e(".content-start").addClass("quickview-blur"),i.addClass("open")},renderQuickView:function(n,o){t&&t.remove(),t=n,e("body").append(n),nret.imageGallery.initImageGallery(),nret.imageGallery.imageGalleryControls(),nret.maps.getMapElements(o),e(".quickview-modal__close").on("click",function(){nret.quickView.closeQuickView()})},closeQuickView:function(){n&&n.show(),e(".quickview-modal").velocity({opacity:0},{display:"none"}),e(".content-start").removeClass("quickview-blur"),e(".quickview-modal").removeClass("open")},quickViewEvents:function(){e(".quickview").on("click",function(t){var n=e(this);nret.quickView.openQuickView(n)})},init:function(){nret.quickView.quickViewEvents()}}}(jQuery);var nret=nret||{};!function(e){nret.retreatSearchWidget={changeLabelOnSelect:function(){e(".global-nav__destinations__destination-list-wrapper").find(".custom-check-input").on("change",function(){var t=" Destinations",n=e(this).parents(".global-nav__destinations__destination-list-wrapper").find(".custom-check-input:checked").length;1===n&&(t=" Destination"),0===n&&(n=""),e(".destination.home__search__choice").text(n+t)})},init:function(){nret.retreatSearchWidget.changeLabelOnSelect()}},jQuery(document).ready(function(){nret.retreatSearchWidget.init()})}(jQuery);var nret=nret||{};!function(e){nret.scrollController={anchorScrolling:function(){var t,n;e(".anchor-link").on("click",function(o){o.preventDefault(),t=e(this).attr("data-link-source"),n=e('*[data-anchor="'+t+'"]'),n.velocity("scroll",{duration:600,offset:-180,easing:"ease-in-out"})})},stickySubNav:function(){var t=e(".booking-widget").length,n=null,o=null,i=null,a=function(t){e(".global-nav").toggleClass("stuck"),"up"==t?e(".booking-widget").removeAttr("style"):"down"==t&&(e(".booking-widget").velocity({top:45},350),e(".booking-widget").velocity({opacity:1},250))},r=function(t){e(".global-nav").toggleClass("stuck"),"up"==t?e(".subnav-container").removeAttr("style"):"down"==t&&(e(".subnav-container").velocity({top:50},350),e(".subnav-container").velocity({opacity:1},250))};switch(t){case 0:n=e(".subnav-container")[0],e(".subnav-container").removeClass("stuck"),o=e(".subnav-container").height()+28,i=function(e){r(e)};break;case 1:n=e(".booking-widget")[0],o=-65,i=function(e){a(e)};break;default:n=e(".booking-widget")[0],o=-65,i=function(e){a(e)}}new Waypoint.Sticky({element:n,handler:function(e){i(e)},offset:o})},pauseVideoOnScrollPosition:function(){if(e("body").hasClass("desktop")&&e(".about__full-video").length>0){new Waypoint.Sticky({element:e(".scroll-catch"),handler:function(e){"up"==e?document.getElementById("aboutBgVid").play():"down"==e&&document.getElementById("aboutBgVid").pause()},offset:550})}},highlightSubnavOnScrollPositionEvent:function(){},highlightSubnavOnScrollPosition:function(){for(var t=e(".subnav li").children(),n=[],o=0;o<t.length;o++){var i=t[o],a=e(i).attr("data-link-source");n.push(a)}e(window).scroll(function(){for(var t=(e(window).scrollTop(),e(window).height(),e(document).height(),0);t<n.length;t++){n[t];throw new Error("break here")}})},init:function(){nret.scrollController.anchorScrolling(),nret.scrollController.pauseVideoOnScrollPosition(),(e(".booking-widget").length>0||e(".subnav-container").length>0)&&(e("body").hasClass("node-type-retreat")||e("body").hasClass("desktop")||window.innerWidth>=900)&&nret.scrollController.stickySubNav()}},jQuery(document).ready(function(){nret.scrollController.init()})}(jQuery);var nret=nret||{};!function(e){nret.search={onSearchKeyUp:function(){nret.search.els.globalSearchInput.bind("keyup change",function(e){nret.search.els.searchQuickLinks.removeClass("show")})},goToSearchPage:function(t){e("#globalSearch, #globalSearchMbl").on("submit",function(t){t.preventDefault();var n=e(this).find("input").val();window.location.href="/search/results/"+n})},openSearchInNav:function(){setTimeout(function(){nret.search.els.globalSearchInput.focus()},500),nret.search.els.globalNavSearchWrapper.velocity({opacity:1},{display:"flex"},{complete:function(){nret.search.els.globalSearchInput.focus()}}),nret.search.els.globalNavSearchWrapper.find("input").focus(),nret.search.els.searchQuickLinks.addClass("show")},closeSearchInNav:function(){nret.search.els.globalNavSearchWrapper.velocity({opacity:0},{display:"none"}),nret.search.els.searchQuickLinks.removeClass("show")},searchInNavInitEvent:function(){e("#closeSearchInNav").on("click",function(){nret.search.closeSearchInNav()}),e("#openSearchInNav").on("click",function(){nret.search.openSearchInNav()})},init:function(){nret.search.els={globalSearchInput:e("#globalSearchInput"),globalNavSearchWrapper:e(".global-nav__search-wrapper"),searchQuickLinks:e(".search__quick-links")},nret.search.searchInNavInitEvent(),nret.search.goToSearchPage(),nret.search.onSearchKeyUp(),nret.search.els.globalSearchInput.autocomplete({appendTo:".page-body",forceFixPosition:!0,serviceUrl:"/search/autocomplete",dataType:"JSON",transformResult:function(e,t){return{suggestions:function(){var t=[];return _.each(e,function(e){var n=_.map(e,function(e){return{value:e.Title,data:e.url}});t.push(n)}),_.flatten(t)}(),query:t}},onSelect:function(e){var t=e.value;window.location.href="/search/results/"+encodeURIComponent(t)}})}},jQuery(document).ready(function(){nret.search.init()})}(jQuery);var nret=nret||{};!function(e){nret.styles={growAnimationFiltersClass:function(){e(".initGrow").on("click",function(t){var n=e(this),o=n.parent().hasClass("input-container")?n.parent().parent():n.parent();$growMeElement=e(".growMe",o),o.toggleClass("open"),e(".filter__options-wrapper__filter-option").not(o).removeClass("open"),e(".growMe").not($growMeElement).removeClass("show"),e(".growMeMore").removeClass("show"),$growMeElement.toggleClass("show"),e(".cal").find(".input-container").removeClass("show"),t.stopPropagation()}),e(".initGrowMore").on("click",function(t){var n=e(".growMeMore"),o=e(this).parent();o.toggleClass("open"),e(".filter__options-wrapper__filter-option").not(o).removeClass("open"),e(".growMe").removeClass("show"),n.toggleClass("show"),e(".cal").find(".input-container").removeClass("show"),t.stopPropagation()})},moveMoreFilterLeft:function(){var t=e(".filter__more__block").eq(0).innerWidth();e("#moreFiltersWrapper").velocity({translateX:"-="+t})},moveMoreFilterLeftEvent:function(){e("#moreOptionsScrollLeft").on("click",function(){nret.styles.moveMoreFilterLeft()})},moveMoreFilterRight:function(){var t=e(".filter__more__block").eq(0).innerWidth();e("#moreFiltersWrapper").velocity({translateX:"+="+t})},moveMoreFilterRightEvent:function(){e("#moreOptionsScrollRight").on("click",function(){nret.styles.moveMoreFilterRight()})},animateNumberCount:function(e,t,n,o){var i=n-t,a=t,r=n>t?1:-1,s=Math.abs(Math.floor(o/i)),l=document.getElementById(e),c=setInterval(function(){a+=r,l.innerHTML=a,a==n&&clearInterval(c)},s)},init:function(){nret.styles.growAnimationFiltersClass(),nret.styles.moveMoreFilterRightEvent(),nret.styles.moveMoreFilterLeftEvent()}},jQuery(document).ready(function(){nret.styles.init()})}(jQuery),function(e){function t(e){s=new YT.Player("ytVideo",{width:600,height:400,videoId:e,playerVars:{controls:0,modestbranding:0,autoplay:1,showinfo:0},events:{onReady:n,onStateChange:function(e){e.data==YT.PlayerState.PLAYING?r():e.data==YT.PlayerState.PAUSED&&r()}}})}function n(){var e;i(),clearInterval(e),e=setInterval(function(){i()},1e3)}function o(){var e=c.requestFullScreen||c.mozRequestFullScreen||c.webkitRequestFullScreen;e&&e.bind(c)()}function i(){var t=s.getCurrentTime()/s.getDuration()*100,n=t+"%";e("#progressBar").find("div").velocity({width:n})}function a(){e(".video__player").velocity({opacity:0},{display:"none"}),s.destroy(),e(".video__player").removeClass("open")}function r(){u=!u,f.attr({from:u?p:h,to:u?h:p}).get(0).beginElement()}var s,l,c,d=!0,u=!1,p="M11,10 L18,13.74 18,22.28 11,26 M18,13.74 L26,18 26,18 18,22.28",h="M11,10 L17,10 17,26 11,26 M20,10 L26,10 26,26 20,26",f=e("#animation"),v=document.createElement("script");v.src="https://www.youtube.com/iframe_api";var m=document.getElementsByTagName("script")[0];m.parentNode.insertBefore(v,m),e("#initVideoPlayer").on("click",function(){e(".video__player").addClass("open"),e(".video__player").velocity({opacity:1},{display:"block"}),l=e(this).attr("data-videoId"),t(l),e(".page-body").addClass("quickview-blur"),e(".video__player").scrollLock()}),e("#progressBar").on("click touchend",function(t){var n=(e("#progressBar").width(),s.getDuration()*(t.clientX/100));s.seekTo(n)}),e(".video__control__share").on("click",function(){var t=e(this).find(".video__control__share__list");d=!d,d===!0?t.velocity({height:0},{duration:200}):t.velocity({height:80},{duration:200})}),e(".video__control__fullscreen").on("click",function(){c=document.getElementById("ytVideo"),o()}),e(".video__control__close").on("click",function(){a(),e(".page-body").removeClass("quickview-blur"),e(".video__player").scrollRelease()}),e(".ytp-play-button").on("click",function(){u===!1?s.playVideo():s.pauseVideo()})}(jQuery);